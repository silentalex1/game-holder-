<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BatProx API</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="style.css">
    <style>
        body { overflow-y: auto; background: #030303; }
        .api-container { max-width: 1000px; margin: 80px auto; padding: 30px; }
        .code-block { background: #0a0a0a; border: 1px solid rgba(255,255,255,0.1); padding: 25px; border-radius: 12px; font-family: 'Courier New', monospace; color: #a855f7; margin: 20px 0; overflow-x: auto; }
        .keyword { color: #f472b6; }
        .string { color: #34d399; }
        .func { color: #60a5fa; }
        h1 { font-size: 48px; margin-bottom: 20px; font-weight: 800; background: linear-gradient(to right, #a855f7, #fff); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .back-btn { position: fixed; top: 30px; left: 30px; color: white; border: 1px solid rgba(255,255,255,0.2); padding: 10px 24px; border-radius: 30px; background: rgba(0,0,0,0.5); backdrop-filter: blur(10px); z-index: 100; text-decoration: none; }
        .btn-gen { background: #a855f7; color: white; padding: 10px 20px; border-radius: 8px; cursor: pointer; border: none; font-weight: bold; margin-top: 15px; }
        .modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.85); backdrop-filter: blur(20px); z-index: 9999; display: flex; justify-content: center; align-items: center; opacity: 0; visibility: hidden; transition: 0.3s; }
        .modal-overlay.active { opacity: 1; visibility: visible; }
        .key-window { width: 400px; background: #111; border: 1px solid #333; border-radius: 16px; padding: 30px; text-align: center; }
        .key-input { width: 100%; padding: 12px; background: #000; border: 1px solid #333; color: white; border-radius: 8px; margin: 15px 0; outline: none; }
        .generated-key { background: #222; padding: 10px; border-radius: 6px; font-family: monospace; color: #a855f7; margin-top: 20px; display: none; }
    </style>
</head>
<body>
    <a href="/" class="back-btn">‚Üê Back</a>
    <div class="api-container">
        <h1>BatProx API</h1>
        <p style="color:#aaa;">Integrate the engine.</p>
        <button class="btn-gen" onclick="openKeyGen()">Generate Key</button>
        
        <div class="code-block">
<span class="keyword">const</span> BatNode = <span class="keyword">new</span> <span class="func">BatProx</span>({ key: <span class="string">"bp_..."</span> });
        </div>
    </div>

    <div class="modal-overlay" id="key-gen-ui">
        <div class="key-window">
            <h3 style="color:white; margin-bottom:10px;">Verification</h3>
            <p style="color:#888; font-size:14px;">Discord User ID:</p>
            <input type="text" class="key-input" id="discord-id-input">
            <button class="btn-gen" style="width:100%" onclick="validateDiscord()">Submit</button>
            <div class="generated-key" id="final-key"></div>
            <button onclick="closeKeyGen()" style="background:transparent; border:none; color:#666; margin-top:10px; cursor:pointer;">Close</button>
        </div>
    </div>

    <script>
        function openKeyGen() { document.getElementById('key-gen-ui').classList.add('active'); }
        function closeKeyGen() { document.getElementById('key-gen-ui').classList.remove('active'); }
        
        function validateDiscord() {
            const id = document.getElementById('discord-id-input').value;
            if(id.length < 17) return alert("Invalid ID");
            
            fetch('/api/v1/discord/validate', { method:'POST', body: JSON.stringify({id}) })
                .then(r=>r.json()).then(d => {
                    if(d.valid) {
                        fetch('/api/v1/keys/create', { method:'POST' })
                        .then(r=>r.json()).then(k => {
                            const keyEl = document.getElementById('final-key');
                            keyEl.innerText = k.key;
                            keyEl.style.display = 'block';
                        });
                    } else {
                        alert("Invalid Discord ID");
                    }
                });
        }
    </script>
</body>
</html>
